var Mt=Object.defineProperty;var $t=(t,e,s)=>e in t?Mt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var T=(t,e,s)=>$t(t,typeof e!="symbol"?e+"":e,s);import{v as It,d as qt,e as m,u as N,h as $,b as I,o as Lt,i as w,k as y,s as ht,B as v,C as k,G as q,Y as L,F as R,Z as B,_ as D,E as U,D as J,a as tt,$ as X}from"./index.684c656d.js";import{d as rt}from"./Caret.2e43336b.js";import{s as Rt}from"./metabox.9787fdb7.js";import{c as G}from"./cleanForSlug.fc011207.js";import{g as et,d as Bt}from"./html.7cb59739.js";import{g as nt,a as it}from"./contentHasAssets.e1428256.js";import{a as Dt,g as E}from"./_baseSet.a2dfaed5.js";import{N as Ut}from"./helpers.2304d5ee.js";import"./translations.d159963e.js";import{_ as p}from"./default-i18n.20001971.js";import{e as ut}from"./regex.8a6101c0.js";import{n as pt,l as Jt,aT as at}from"./runtime-dom.esm-bundler.d8b05b6d.js";function Kt(t,e,s){return t==null?t:Dt(t,e,s)}const d="all-in-one-seo-pack",jt=()=>{const t=[{slug:"article",graphName:"Article",label:p("Article",d)},{slug:"book",graphName:"Book",label:p("Book",d)},{slug:"course",graphName:"Course",label:p("Course",d)},{slug:"dataset",graphName:"Dataset",label:p("Dataset",d)},{slug:"event",graphName:"Event",label:p("Event",d)},{slug:"faq-page",graphName:"FAQPage",label:p("FAQ",d)},{slug:"fact-check",graphName:"FactCheck",label:p("Fact Check",d)},{slug:"how-to",graphName:"HowTo",label:p("How To",d)},{slug:"job-posting",graphName:"JobPosting",label:p("Job Posting",d)},{slug:"movie",graphName:"Movie",label:p("Movie",d)},{slug:"music",graphName:"Music",label:p("Music",d)},{slug:"person",graphName:"Person",label:p("Person",d)},{slug:"product",graphName:"Product",label:p("Product",d)},{slug:"product-review",graphName:"ProductReview",label:p("Product Review",d)},{slug:"car",graphName:"Car",label:p("Car",d)},{slug:"recipe",graphName:"Recipe",label:p("Recipe",d)},{slug:"service",graphName:"Service",label:p("Service",d)},{slug:"software-application",graphName:"SoftwareApplication",label:p("Software",d)},{slug:"video",graphName:"Video",label:p("Video",d)},{slug:"web-page",graphName:"WebPage",label:p("Web Page",d)}],e={Article:[{childGraphName:"BlogPosting",label:p("Blog Post",d)},{childGraphName:"NewsArticle",label:p("News Article",d)}],Music:[{childGraphName:"MusicAlbum",label:p("Music Album",d)},{childGraphName:"MusicGroup",label:p("Music Group",d)}],WebPage:[{childGraphName:"WebPage",label:p("Web Page",d)},{childGraphName:"AboutPage",label:p("About Page",d)},{childGraphName:"CheckoutPage",label:p("Checkout Page",d)},{childGraphName:"CollectionPage",label:p("Collection Page",d)},{childGraphName:"ContactPage",label:p("Contact Page",d)},{childGraphName:"ItemPage",label:p("Item Page",d)},{childGraphName:"MedicalWebPage",label:p("Medical Page",d)},{childGraphName:"ProfilePage",label:p("Profile Page",d)},{childGraphName:"RealEstateListing",label:p("Real Estate Listing",d)},{childGraphName:"SearchResultsPage",label:p("Search Results Page",d)}]};return{childGraphs:e,graphs:t,initSchemaEditor:o=>{const n=gt(),c=JSON.stringify(n.graph);n.graph=It(o,n.graph);const i=JSON.stringify(n.graph);JSON.stringify(c)!==JSON.stringify(i)&&(n.isDirty=!0)},getGraphObject:(o,n=!1)=>{var c;return!n&&((c=o==null?void 0:o.properties)==null?void 0:c.type)!==o.graphName&&e[o.graphName]?e[o.graphName].find(i=>i.childGraphName===o.properties.type):t.find(i=>i.slug===o.slug)},getParentGraphName:o=>{let n="";return Object.entries(e).forEach(c=>{const i=c[0];c[1].forEach(u=>{n||o===u.childGraphName&&(n=i)})}),n||o}}},gt=qt("SchemaStore",{state:()=>({custom:{graphName:"",schema:""},defaultGraphParent:"",graph:null,graphCardsKey:0,isDirty:!1,isEditingCustomGraph:!1,isEditingCustomTemplate:!1,isEditingDefaultGraph:!1,isEditingGraph:!1,isEditingTemplate:!1,modalOpenMetabox:!1,modalOpenSidebar:!1,output:"",outputKey:0,tabs:{generator:"schema-templates",templates:"schema-catalog"},templateName:"",previousOutputRequestData:null}),actions:{getCustomObject(){return{id:"#aioseo-custom-"+new Date().getTime().toString(36),custom:!0,graphName:this.custom.graphName,schema:this.custom.schema}},resetSessionState(){this.custom={graphName:"",schema:""},this.defaultGraphParent="",this.graph=null,this.templateName="",this.isEditingCustomGraph=!1,this.isEditingCustomTemplate=!1,this.isEditingDefaultGraph=!1,this.isEditingGraph=!1,this.isEditingTemplate=!1,this.isDirty=!1},addCustomAsGraph(){const t=m();t.currentPost.schema.customGraphs.push(this.getCustomObject()),t.currentPost.schema.customGraphs=t.currentPost.schema.customGraphs.sort((e,s)=>e.graphName<s.graphName?-1:1),this.resetSessionState(),this.graphCardsKey=this.graphCardsKey+1,this.modalOpenMetabox=!1,this.modalOpenSidebar=!1},addCustomAsTemplate(){const t=N(),e={...this.getCustomObject()},s={...JSON.parse(JSON.stringify(e)),label:"Custom Schema - "+e.graphName};t.internalOptions.internal.schema.templates.push(this.getCustomObject()),this.resetSessionState(),this.setTabTemplates("your-templates"),$.post(I.restUrl("schema/templates")).send({template:s}).then(a=>{a.body.success&&a.body.templates&&this.parseAndUpdateTemplates(a.body.templates)})},addCustomTemplateAsGraph(){const t=m();t.currentPost.schema.customGraphs.push(this.graph),t.currentPost.schema.customGraphs=t.currentPost.schema.customGraphs.sort((e,s)=>e.graphName<s.graphName?-1:1),this.resetSessionState(),this.graphCardsKey=this.graphCardsKey+1,this.modalOpenMetabox=!1,this.modalOpenSidebar=!1},addDefaultGraph(){const t=m();t.currentPost.schema.default.isEnabled=!0,this.resetSessionState(),this.graphCardsKey=this.graphCardsKey+1,this.modalOpenMetabox=!1,this.modalOpenSidebar=!1},addGraph(){const t=m();t.currentPost.schema.graphs.push(this.graph),t.currentPost.schema.graphs=t.currentPost.schema.graphs.sort((e,s)=>e.graphName<s.graphName?-1:1),this.resetSessionState(),this.graphCardsKey=this.graphCardsKey+1,this.modalOpenMetabox=!1,this.modalOpenSidebar=!1},addGraphAsTemplate(){var a,r,o,n,c;const t=jt();(r=(a=this.graph)==null?void 0:a.properties)!=null&&r.type&&this.graph.properties.type!==this.graph.graphName?this.graph.label=((o=t.getGraphObject(this.graph,!0))==null?void 0:o.label)+" - "+((n=t.getGraphObject(this.graph))==null?void 0:n.label)+" - "+this.templateName:this.graph.label=((c=t.getGraphObject(this.graph,!0))==null?void 0:c.label)+" - "+this.templateName;const e=JSON.parse(JSON.stringify(this.graph));N().internalOptions.internal.schema.templates.push(this.graph),this.resetSessionState(),this.setTabTemplates("your-templates"),$.post(I.restUrl("schema/templates")).send({template:e}).then(i=>{i.body.success&&i.body.templates&&this.parseAndUpdateTemplates(i.body.templates)})},addTemplateAsGraph(t,e=""){let a=N().internalOptions.internal.schema.templates;if(e){const n=new RegExp(ut(e).replace(/\s/g,"\\s"),"i");a=a.filter(c=>{var i;return(i=c==null?void 0:c.label)==null?void 0:i.match(n)})}t===void 0&&(t=a.findIndex(n=>n.id===this.graph.id));const r=JSON.parse(JSON.stringify(a[t]));r.id=r.id+new Date().getTime().toString(18);const o=m();r.custom?(o.currentPost.schema.customGraphs.push(r),o.currentPost.schema.customGraphs=o.currentPost.schema.customGraphs.sort((n,c)=>n.graphName<c.graphName?-1:1)):(o.currentPost.schema.graphs.push(r),o.currentPost.schema.graphs=o.currentPost.schema.graphs.sort((n,c)=>n.graphName<c.graphName?-1:1)),this.resetSessionState(),this.graphCardsKey=this.graphCardsKey+1,this.modalOpenMetabox=!1,this.modalOpenSidebar=!1},deleteCustomGraph(t){const e=m();t===void 0&&(t=e.currentPost.schema.customGraphs.findIndex(s=>s.id===this.graph.id)),e.currentPost.schema.customGraphs.splice(t,1),this.resetSessionState(),this.graphCardsKey=this.graphCardsKey+1,this.modalOpenMetabox=!1,this.modalOpenSidebar=!1},deleteDefaultGraph(){const t=m();t.currentPost.schema.default.isEnabled=!1,this.resetSessionState(),this.graphCardsKey=this.graphCardsKey+1,this.modalOpenMetabox=!1,this.modalOpenSidebar=!1},deleteGraph(t){const e=m();t===void 0&&(t=e.currentPost.schema.graphs.findIndex(s=>s.id===this.graph.id)),e.currentPost.schema.graphs.splice(t,1),this.resetSessionState(),this.graphCardsKey=this.graphCardsKey+1,this.modalOpenMetabox=!1,this.modalOpenSidebar=!1},deleteTemplate(t){const e=this.graph.id,s=N();t===void 0&&(t=s.internalOptions.internal.schema.templates.findIndex(a=>a.id===e)),s.internalOptions.internal.schema.templates.splice(t,1),this.resetSessionState(),this.setTabTemplates("your-templates"),$.delete(I.restUrl("schema/templates")).send({templateId:e}).then(a=>{a.body.success&&a.body.templates&&this.parseAndUpdateTemplates(a.body.templates)})},editCustomGraph({customGraphIndex:t,isSidebar:e}){const s=m(),a=JSON.parse(JSON.stringify(s.currentPost.schema.customGraphs[t]));this.graph=a,this.isEditingCustomGraph=!0,this.tabs.generator="custom-schema",e?this.modalOpenSidebar=!0:this.modalOpenMetabox=!0},editDefaultGraph({isSidebar:t,parentGraphName:e}){this.defaultGraphParent=e;const s=m();s.currentPost.schema.default.data[e]&&(this.graph=s.currentPost.schema.default.data[e]),this.isEditingDefaultGraph=!0,this.tabs.generator="schema-templates",t?this.modalOpenSidebar=!0:this.modalOpenMetabox=!0},async editGraph({graphIndex:t,isSidebar:e}){const s=m(),a=JSON.parse(JSON.stringify(s.currentPost.schema.graphs[t]));this.graph=a,this.isEditingGraph=!0,this.tabs.generator="schema-templates",e?this.modalOpenSidebar=!0:this.modalOpenMetabox=!0,await pt(),this.isDirty=!1},async editTemplate(t,e=""){let a=N().internalOptions.internal.schema.templates;if(e){const o=new RegExp(ut(e).replace(/\s/g,"\\s"),"i");a=a.filter(n=>n.label.match(o))}const r=JSON.parse(JSON.stringify(a[t]));if(this.graph=r,r.custom)this.templateName=this.graphName,this.isEditingCustomTemplate=!0,this.tabs.generator="custom-schema";else{const o=new RegExp(`^${this.graph.graphName} -`,"i"),n=this.graph.label.replace(o,"");this.templateName=n,this.isEditingTemplate=!0}await pt(),this.isDirty=!1},updateCustomGraph(){const t=m(),e=t.currentPost.schema.customGraphs.findIndex(s=>s.id===this.graph.id);e!==-1&&(t.currentPost.schema.customGraphs[e]=this.graph,t.currentPost.schema.customGraphs=t.currentPost.schema.customGraphs.sort((s,a)=>s.graphName<a.graphName?-1:1),this.resetSessionState(),this.graphCardsKey=this.graphCardsKey+1,this.modalOpenMetabox=!1,this.modalOpenSidebar=!1)},updateDefaultGraph(){const t=m();t.currentPost.schema.default.data[this.defaultGraphParent]=this.graph,this.resetSessionState(),this.graphCardsKey=this.graphCardsKey+1,this.modalOpenMetabox=!1,this.modalOpenSidebar=!1},updateGraph(){const t=m(),e=t.currentPost.schema.graphs.findIndex(s=>s.id===this.graph.id);e!==-1&&(t.currentPost.schema.graphs[e]=this.graph,t.currentPost.schema.graphs=t.currentPost.schema.graphs.sort((s,a)=>s.graphName<a.graphName?-1:1),this.resetSessionState(),this.graphCardsKey=this.graphCardsKey+1,this.modalOpenMetabox=!1,this.modalOpenSidebar=!1)},updateSchemaOutput(){const t=m();if(Lt().isUnlicensed)return;let s=t.currentPost.id;if(w()&&(s=window.wp.data.select("core/editor").getCurrentPostId()),!s||t.currentPost.context!=="post")return;const a={postId:s,graphs:t.currentPost.schema.graphs,customGraphs:t.currentPost.schema.customGraphs,default:t.currentPost.schema.default,blockGraphs:t.currentPost.schema.blockGraphs};JSON.stringify(a)!==this.previousOutputRequestData&&(this.previousOutputRequestData=JSON.stringify(a),$.post(I.restUrl("schema/validator/output")).send(a).then(r=>{if(r.body.success&&r.body.output){let o=null;try{o=JSON.parse(r.body.output)}catch{return}if(r.body.output=JSON.stringify(o,null,"	").trim(),r.body.output===this.output)return;this.output=r.body.output,this.outputKey=this.outputKey+1}}))},updateTemplate(){this.graph.label=this.graph.graphName+" - "+this.templateName;const t=JSON.parse(JSON.stringify(this.graph)),e=N(),s=e.internalOptions.internal.schema.templates.findIndex(a=>a.id===this.graph.id);s!==-1&&(e.internalOptions.internal.schema.templates[s]=this.graph,this.resetSessionState(),this.setTabTemplates("your-templates"),$.put(I.restUrl("schema/templates")).send({template:t}).then(a=>{a.body.success&&a.body.templates&&this.parseAndUpdateTemplates(a.body.templates)}))},parseAndUpdateTemplates(t){t=t.map(s=>(typeof s!="string"||(s=JSON.parse(s)),s)),t=t.sort((s,a)=>{const r=s.custom?0:1;return s.graphName<a.graphName?-1:r});const e=N();e.internalOptions.internal.schema.templates=t},setModalOpen({isOpen:t,initialTab:e,isSidebar:s}){t||(this.resetSessionState(),this.setTabTemplates("schema-catalog")),s?this.modalOpenSidebar=t:this.modalOpenMetabox=t,e&&(this.tabs.generator=e)},setTabTemplates(t){this.tabs.generator="schema-templates",this.tabs.templates=t}}}),Wt=t=>{var s;if(typeof(window==null?void 0:window.acf)!="object"||typeof((s=window.acf)==null?void 0:s.getField)!="function")return null;const e=window.acf.getField(t)||{};return typeof(e==null?void 0:e.val)!="function"?null:e.val()||{}},ft=()=>{const e=m().currentPost.postType;if(!e)return"";const a=N().dynamicOptions.searchAppearance.postTypes[e].customFields;if(!a||!_t)return"";const r=()=>{M(500)},o=a.replace(/\n/g,",").split(","),n=[],c=["INPUT","TEXTAREA","IMG"];o.forEach(u=>{u=u.trim();const l=document.getElementById(`${u}`)||{},f=document.querySelectorAll("#the-list > tr"),C=document.querySelectorAll(".acf-field");c.includes(l==null?void 0:l.tagName)&&!(l!=null&&l.closest(".acf-field"))?n.push(l):f.forEach(h=>{const g=h.querySelector(`#${h.id}-key`),S=h.querySelector(`#${h.id}-value`);c.includes(S==null?void 0:S.tagName)&&o.includes(g==null?void 0:g.value)&&n.push(S)}),C.forEach(h=>{var S;if(u!==h.dataset.name||h.dataset.type==="repeater"||(S=h.parentNode)!=null&&S.closest(".acf-repeater"))return"";let g=h.querySelector(`[id^="acf"][name$="[${h.dataset.key}]"]`);if(h.dataset.type==="image"&&(g=h.querySelector(".has-value img")),h.dataset.type==="gallery"&&(g=h.querySelector(".acf-gallery-attachment img")),h.dataset.type==="link"&&(g=Wt(h.dataset.key)||h.querySelector(`[name$="[${h.dataset.key}][url]"]`)||{},g={tagName:"INPUT",type:"url",value:(g==null?void 0:g.url)??(g==null?void 0:g.value)??""}),!g||g.type&&g.type==="hidden")return"";if(h.dataset.type==="wysiwyg"){const P=window.setInterval(()=>{var F,Q;(Q=(F=window.tinyMCE)==null?void 0:F.activeEditor)!=null&&Q.acf&&(window.clearInterval(P),window.tinyMCE.activeEditor.on("keyup",function(){M(500)}),window.tinyMCE.activeEditor.on("PostProcess",function(){rt(()=>{M(500)},10)}))},50),Ot=function(F){F.forEach(Q=>{var lt;if(Q.attributeName==="class"&&h.querySelector(".wp-editor-wrap.tmce-active")&&((lt=window.tinyMCE)!=null&&lt.activeEditor)){window.tinyMCE.activeEditor.on("keyup",function(){M(500)});const st=h.querySelector(`[name="acf[${h.dataset.key}]"]`);st&&(st.addEventListener("keyup",()=>{M(500)}),st.addEventListener("paste",()=>{M(500)}))}})},Gt=new MutationObserver(Ot),ct=h.querySelector(".wp-editor-wrap");ct&&Gt.observe(ct,{attributes:!0})}c.includes(g.tagName)&&n.push(g)})});let i="";return n.forEach(u=>{let l="";if(c.includes(u.tagName)&&typeof(u==null?void 0:u.addEventListener)=="function"&&u.addEventListener("keyup",r),u.value&&(l=u.value),u.tagName==="IMG"&&u.src){const f=u.alt?`alt="${u.alt}"`:"";l=`<img src="${u.src}" ${f}>`}u.value&&u.type&&u.type==="url"&&(l=`<a href="${l}">${l}</a>`),l&&(i+=`${l} `)}),i},Ht=(t,e=["INPUT","TEXTAREA","IMG"])=>{if(!t)return"";const s=document.getElementById(`${t}`),a=document.querySelectorAll("#the-list > tr"),r=document.querySelectorAll(".acf-field");let o="";if(s&&e.indexOf(s.tagName)!==-1&&(s.closest(".acf-field")||(o=s.tagName==="IMG"?s.getAttribute("src"):s.value)),a.length&&a.forEach(n=>{const c=n.querySelector(`#${n.id}-key`),i=n.querySelector(`#${n.id}-value`);i&&e.indexOf(i.tagName)!==-1&&c.value===t&&(o=i.tagName==="IMG"?i.getAttribute("src"):i.value)}),r.length){const n=[];r.forEach(c=>{var u;if(t!==c.dataset.name||c.dataset.type==="repeater"||(u=c.parentNode)!=null&&u.closest(".acf-repeater"))return;let i;e.forEach(l=>{const f=l.toLowerCase();i=c.querySelector(`[data-key="${c.dataset.key}"] ${f}`)||i}),i&&n.push(i.tagName==="IMG"?i.getAttribute("src"):i.value)}),o=n.join(" ")}return o},Vt=({separator:t})=>{const e=Jt(t);return{parseTags:a=>{const r=y();return!a||!r.tags?a:(r.tags.forEach(o=>{if(o.id==="custom_field"){const u=new RegExp(`#${o.id}-([a-zA-Z0-9_-]+)`,"g"),l=a.match(u);l&&l.forEach(f=>{const C=new RegExp(`#${o.id}-([a-zA-Z0-9_-]+)`),h=f.match(C);h&&h[1]&&(a=a.replace(C,Ht(h[1])))});return}if(o.id==="tax_name"){const u=new RegExp(`#${o.id}-([a-zA-Z0-9_-]+)`,"g");a=a.replace(u,`[${o.name} - $1]`);return}const n=new RegExp(`#${o.id}(?![a-zA-Z0-9_])`,"g");o.id==="separator_sa"&&e.value!==void 0&&(a=a.replace(n,e.value));const c=a.match(n),i=r.liveTags[o.id]||o.value;c&&(a=a.replace(n,"%|%"+i))}),a=a.replace(/%\|%/g,""),ht(a))},separator:e}},zt=()=>{const t=window.elementor.documents.getCurrent(),e=[];return t.$element?(t.$element.find(".elementor-widget").each((s,a)=>{const r=a.innerHTML.trim().replaceAll(/<div class="elementor-widget-container">(.*)<\/div>/g,"$1").replaceAll(/<p.*>(<img.*>)<\/p>/g,"$1");et(r)===""&&nt(r)===0&&it(r)===0||e.push(r)}),e.join(" ")):""},K=()=>{var s;const{settings:t,config:e}=window.elementor;return{content:zt(),title:t.page.model.get("post_title"),excerpt:t.page.model.get("post_excerpt")||"",slug:G(t.page.model.get("post_title")),permalink:e.document.urls.permalink||"",featuredImage:((s=t.page.model.get("post_featured_image"))==null?void 0:s.url)||""}},Zt=()=>{const t=E(ET_Builder,"Frames.app.frameElement",document.querySelector("iframe#et-fb-app-frame"));if(!t)return document.createElement("div");let e=t.contentWindow.document.querySelectorAll("#et-fb-app");return 1<e.length&&(e=[...e].filter(s=>s.classList.contains("et-fb-root-ancestor"))),e[0]||document.createElement("div")},Ft=()=>{const t=[],e=Zt().querySelectorAll(".et_pb_section"),s=new RegExp(["<style.*?</style>","\\[object Object\\]"].join("|"),"gi");for(const a of e){const r=a.innerHTML.replace(s,"").replaceAll(/<p.*>(<img.*>)<\/p>/g,"$1");et(r)===""&&nt(r)===0&&it(r)===0||t.push(r)}return t.join(" ")},Qt=()=>{const t=new URL(E(ETBuilderBackendDynamic,"currentPage.permalink",""));return t.searchParams.delete("PageSpeed"),t.href},Xt=async()=>{const{wp:t}=window,e=E(ETBuilderBackendDynamic,"currentPage.thumbnailId",0);if(!t||e===0)return"";const s=t.media.attachment(e);let a="";return await s.fetch().then(()=>{a=s.get("url"),Kt(ETBuilderBackendDynamic,"currentPage.thumbnailUrl",a)}),a},j=()=>{const t=E(ETBuilderBackendDynamic,"postMeta.post_name","")||G(E(ETBuilderBackendDynamic,"postTitle",""));return{content:Ft(),title:E(ETBuilderBackendDynamic,"postTitle",""),excerpt:E(ETBuilderBackendDynamic,"postMeta.post_excerpt",""),slug:t,permalink:Qt(),featuredImage:Xt()}},Yt=t=>{let e;switch(t.type){case"header":e=document.createElement(t.settings.tag),e.innerHTML=t.settings.headerTxt.trim();break;case"image":const s=document.createElement("img");t.settings.altTxt&&s.setAttribute("alt",t.settings.altTxt),t.settings.src&&s.setAttribute("src",t.settings.src),t.settings.noFollow&&s.setAttribute("rel","nofollow"),e=s,t.settings.link&&(e=document.createElement("a"),e.setAttribute("href",t.settings.link),e.innerHTML=s.outerHTML,t.settings.noFollow&&e.setAttribute("rel","nofollow"),t.settings.openNewWindow&&e.setAttribute("target","_blank"));break;case"video":t.settings.type==="youtube"?(e=document.createElement("iframe"),e.setAttribute("src",t.settings.youtubeUrl)):(e=document.createElement("div"),e.innerHTML=t.settings.code);break;case"text":e=document.createElement("div"),e.innerHTML=t.settings.txt.trim();break;case"button":e=document.createElement("a"),e.appendChild(document.createTextNode(t.settings.btnTxt+" "+t.settings.btnSubTxt)),t.settings.link&&e.setAttribute("href",t.settings.link),t.settings.altTxt&&e.setAttribute("alt",t.settings.altTxt),t.settings.src&&e.setAttribute("src",t.settings.src),t.settings.noFollow&&e.setAttribute("rel","nofollow"),t.settings.openNewWindow&&e.setAttribute("target","_blank");break;case"bullet-list":e=document.createElement("ul"),t.settings.items.forEach(a=>{const r=document.createElement("li");r.innerHTML=a.txt,e.appendChild(r)});break;case"custom-html":e=document.createElement("div"),e.innerHTML=t.settings.code;break}return e},te=()=>{const t=[];return JSON.parse(JSON.stringify(E(seedprod_data,"settings.document.sections",[]))).forEach(s=>{s.rows.forEach(a=>{a.cols.forEach(r=>{r.blocks.forEach(o=>{const n=Yt(o);n&&(et(n)===""&&nt(n)===0&&it(n)===0||t.push(n.outerHTML))})})})}),t.join(" ")},ee=()=>{const t=E(seedprod_data,"home_url",""),e=E(seedprod_data,"settings.post_name","");return`${t}/${e}/`},W=()=>({content:te(),title:E(seedprod_data,"settings.post_title",""),excerpt:"",slug:E(seedprod_data,"settings.post_name",""),permalink:ee()}),se=()=>m().currentPost.processedContent,dt=t=>{var e,s;if(t==="admin_frontend_editor"){const{vc:a}=window;return a.builder.getTitle()||((e=document.querySelector("#vc_page-title-field"))==null?void 0:e.value)}return((s=document.getElementById("#title"))==null?void 0:s.value)||""},ae=t=>{var e,s;if(t==="admin_frontend_editor"){const{vc_iframe_src:a}=window,r=new URL(a).pathname.split("/").filter(o=>o);return r[r.length-1]||((e=document.querySelector("#vc_post_name"))==null?void 0:e.value)}return((s=document.querySelector("#post_name"))==null?void 0:s.value)||""},re=t=>{var e;if(t==="admin_frontend_editor"){const{vc_iframe_src:s}=window;return s.replace(new URL(s).search,"")}return((e=document.querySelector("#sample-permalink a"))==null?void 0:e.href)||""},H=()=>{const{vc_mode:t}=window,e=ae(t)||G(dt(t));return{content:se(),title:dt(t),excerpt:"",slug:e,permalink:re(t),featuredImage:""}},oe=()=>{var e;return((e=m().currentPost)==null?void 0:e.processedContent)||""},ne=()=>{var e;const{FusionApp:t}=window;return(t==null?void 0:t.getPost("post_title"))||((e=document.getElementById("#title"))==null?void 0:e.value)||""},ie=()=>{var e;const{FusionApp:t}=window;return(t==null?void 0:t.getPost("post_name"))||((e=document.querySelector("#post_name"))==null?void 0:e.value)||""},ce=()=>{var e;const{FusionApp:t}=window;return(t==null?void 0:t.getPost("post_permalink").replace("?fb-edit=1",""))||((e=document.querySelector("#sample-permalink a"))==null?void 0:e.href)||""},le=async()=>{const{wp:t,FusionApp:e}=window;if(!t||!e||!e.getDynamicPost("post_meta")._thumbnail_id)return"";const s=t.media.attachment(e.getDynamicPost("post_meta")._thumbnail_id);let a="";return await s.fetch().then(()=>{a=s.get("url")}),a},V=()=>({content:oe(),title:ne(),excerpt:"",slug:ie(),permalink:ce(),featuredImage:le()}),ue=()=>{let t="";const e=["p","a","img","caption","br","video","iframe","blockquote","cite","em","strong","i","b","q","h1","h2","h3","h4","h5","h6","ul","ol","li","table","tr","th","td"],s=function(r){var n;const o=Bt(r);if(o.querySelectorAll(".so-panel").length===0)return r;for(const c of o.querySelectorAll("iframe, script, style, link"))c.remove();return o.querySelectorAll("*").forEach(c=>{if(!e.includes(c.tagName.toLowerCase())){const i=Array.from(c.childNodes);c.replaceWith(...i)}}),((n=o.innerHTML)==null?void 0:n.replace(/[\t|\n]/gm," "))||""},{soPanelsBuilderView:a}=window;return a&&(Array.isArray(a)?a.forEach(function(r){t+=s(r.contentPreview)}):t=s(a.contentPreview)),t},z=()=>({content:ue(),title:"",excerpt:"",slug:"",permalink:"",featuredImage:""}),pe=()=>{var t,e;return((e=(t=TVE==null?void 0:TVE.Editor_Page)==null?void 0:t.content_manager)==null?void 0:e.get_clean_content())||""},mt=()=>{var t,e;return((e=(t=TVE==null?void 0:TVE.CONST)==null?void 0:t.post)==null?void 0:e.post_title)||""},de=()=>{var t,e;return((e=(t=TVE==null?void 0:TVE.CONST)==null?void 0:t.post)==null?void 0:e.post_name)||""},me=()=>{var t;return((t=TVE==null?void 0:TVE.CONST)==null?void 0:t.post_url)||""},he=()=>{var e,s,a,r,o;const t=((a=(s=(e=TVE==null?void 0:TVE.CONST)==null?void 0:e.theme)==null?void 0:s.post_featured_image)==null?void 0:a.src)||((o=(r=TVE==null?void 0:TVE.CONST)==null?void 0:r.post_image)==null?void 0:o.featured)||"";return t.includes("inc/assets/images/featured_image.png")?"":t},Z=()=>({content:pe(),title:mt(),excerpt:"",slug:de()||G(mt()),permalink:me(),featuredImage:he()}),St=()=>{let t="";switch(!0){case J():t=K().slug;break;case U():t=j().slug;break;case D():t=W().slug;break;case B():t=H().slug;break;case R():t=V().slug;break;case L():t=z().slug;break;case q():t=Z().slug;break}return t},ge=()=>{const t=y();if(t.permalinkSlug)return t.permalinkSlug;let e="";if(v()||k()){const s=document.querySelector("#post_name");s&&(e=G(s.value))}return w()&&(e=window.wp.data.select("core/editor").getCurrentPost().slug),e||(e=St()),e&&t.updatePermalinkSlug(e),e},ot=()=>{var e,s,a,r;let t="";if(v()||k()){const n=((e=document.querySelector("#post_name"))==null?void 0:e.value)||((s=document.querySelector("#editable-post-name-full"))==null?void 0:s.textContent)||document.querySelector("#title").value;n&&(t=G(n))}return w()&&(typeof((r=(a=window.wp)==null?void 0:a.data)==null?void 0:r.select("core/editor").getEditedPostSlug)=="function"?t=window.wp.data.select("core/editor").getEditedPostSlug():t=window.wp.data.select("core/editor").getEditedPostAttribute("slug")),t||(t=St()),t},fe=async(t=!0)=>{let e=ge();const s=ot();if(e!==s){e=s;const a=m();if(y().updatePermalinkSlug(e),!t)return;new x().runAnalysis({postId:a.currentPost.id,postData:{...a.currentPost},content:_(),slug:O()})}},yt=()=>{let t="";switch(!0){case J():t=K().permalink;break;case U():t=j().permalink;break;case D():t=W().permalink;break;case B():t=H().permalink;break;case R():t=V().permalink;break;case L():t=z().permalink;break;case q():t=Z().permalink;break}return t},Se=()=>{const t=y();if(t.liveTags.permalink)return t.liveTags.permalink;let e;if(v()||k){const s=document.querySelector("#edit-slug-box a");s&&s.href&&(e=s.href)}return w()&&(e=window.wp.data.select("core/editor").getPermalink()),e||(e=yt()),e&&t.updatePermalink(e),e},O=()=>{const t=tt();let e;if(v()||k()){const s=document.querySelector("#edit-slug-box a");s&&s.href&&(e=s.href)}if(w()&&(e=window.wp.data.select("core/editor").getPermalink()),e||(e=yt()),e&&t.aioseo.data.usingPermalinks&&ot()){const s=new URL(e),a=s.pathname.split("/").filter(r=>r!=="");a[0<a.length?a.length-1:0]=ot(),s.pathname=a.join("/")+(s.pathname.endsWith("/")?"/":""),s.search="",s.hash="",e=s.toString()}return decodeURIComponent(e)},ye=async(t=!0)=>{let e=Se();const s=O();if(e!==s&&(e=s,e)){const a=m();if(y().updatePermalink(e),!t)return;new x().runAnalysis({postId:a.currentPost.id,postData:{...a.currentPost},content:_(),slug:O()})}},be=t=>{var a;const e=t.getBody()||{},s=(e==null?void 0:e.childNodes)||[];return 1<s.length?!1:s.length===0?!0:1<((a=s[0])==null?void 0:a.childNodes.length)?!1:/^\n?$/.test((e==null?void 0:e.innerText)||(e==null?void 0:e.textContent)||"")},bt=/base64,(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)/g,wt=["acf","aioseo","core"],Et=()=>{let t="";switch(!0){case J():t=K().content;break;case U():t=j().content;break;case D():t=W().content;break;case B():t=H().content;break;case R():t=V().content;break;case L():t=z().content;break;case q():t=Z().content;break}return t},Pt=t=>{var a;if(!t.includes('<!-- wp:block {"ref":'))return t;const e=(a=window.wp.blocks)==null?void 0:a.rawHandler({HTML:t});return Ut(e).forEach(r=>{var o,n,c;if(r.name==="core/block"){const i=window.wp.data.select("core").getEntityRecord("postType","wp_block",(o=r.attributes)==null?void 0:o.ref);(n=i==null?void 0:i.content)!=null&&n.raw&&(t=t.replace(`<!-- wp:block {"ref":${(c=r.attributes)==null?void 0:c.ref}} /-->`,i.content.raw))}}),t},Tt=(t,e)=>(window.wp.data.select("core/block-editor").getBlocks().forEach(a=>{const[r,o]=a.name.split("/");if(e.includes(r)){if(r==="core"&&o!=="table")return;const n=document.getElementById("block-"+a.clientId);if(n&&n.innerText){const c=r==="core"?o:a.name,i=`<!-- wp:${c}.*?/wp:${c} -->|<!-- wp:${c}.*?/-->`;t=t.replace(new RegExp(i,"s"),n.innerText)}}}),t),vt=()=>{const t=y();if(t.liveTags.post_content)return t.liveTags.post_content;let e="";if(v()&&!X())if(window.tinyMCE||document.querySelector("#wp-content-wrap.html-active"))e=Y();else{const a=window.setInterval(()=>{window.tinyMCE&&(window.clearInterval(a),e=Y())},50)}return w()&&(e=window.wp.data.select("core/editor").getCurrentPost().content||"",e=Pt(e),e=Tt(e,wt)),X()&&(e=Et()),m().currentPost.descriptionIncludeCustomFields&&(e=e+ft()),e=e.replace(bt,""),e&&t.updatePostContent(e),e},_=(t=!1)=>{let e="";if(v()&&!X())if(window.tinyMCE||document.querySelector("#wp-content-wrap.html-active"))e=Y();else{const a=window.setInterval(()=>{window.tinyMCE&&(window.clearInterval(a),e=Y())},50)}w()&&(e=window.wp.data.select("core/editor").getEditedPostContent(),e=Pt(e),e=Tt(e,wt)),X()&&(e=Et());const s=m();return!t&&s.currentPost.descriptionIncludeCustomFields&&(e=e+ft()),e=e.replace(bt,""),e},we=async(t=!0)=>{let e=vt();const s=_();if(e!==s){e=s;const a=m();if(y().updatePostContent(e),!t)return;new x().runAnalysis({postId:a.currentPost.id,postData:{...a.currentPost},content:_(),slug:O()})}},Y=()=>{let t;const e=window.tinyMCE?window.tinyMCE.get("content"):"";if(document.querySelector("#wp-content-wrap.tmce-active")&&e)t=e.getContent({format:be(e)?"html":"raw"});else{const s=document.querySelector("textarea#content");t=s?s.value:""}return t};function Ee(t){return new Worker(""+window.__aioseoDynamicImportPreload__("main-4vgbr8_9.js"),{name:t==null?void 0:t.name})}class x{constructor(){T(this,"postId",null);T(this,"postTitle",null);T(this,"postParsedTitle",null);T(this,"postParsedDescription",null);T(this,"postDescription",null);T(this,"keyphrases",null);T(this,"postContent",null);T(this,"postSlug",null);T(this,"isAnalyzing",!1);T(this,"worker",null)}async runAnalysis({postId:e,postData:s,content:a=_(),slug:r=O()}){var S;const o=m(),n=N();if(s=s||{...o.currentPost},!((S=n.options.advanced)!=null&&S.truSeo)||!o.currentPost.page_analysis||this.isAnalyzing)return;this.worker&&this.worker.terminate();const c={separator:ht(n.options.searchAppearance.global.separator)},{parseTags:i}=Vt({separator:c.separator}),u=tt(),l=y(),f=l.tags.map(P=>l.liveTags[P.id]!==void 0&&P.value!==l.liveTags[P.id]?{...P,value:l.liveTags[P.id]}:P),C={...at(u.aioseo),tags:at(f),currentPost:at(o.currentPost)},h=JSON.parse(JSON.stringify({postId:e,postData:s,content:a,aioseo:C,slug:r,aioseoGlobals:c,postEditedTitle:Ct(),postTitle:s.title||s.metaDefaults.title||"#post_title",postParsedTitle:i(s.title||s.metaDefaults.title||"#post_title"),postDescription:s.description||s.metaDefaults.description,postParsedDescription:i(s.description||s.metaDefaults.description)}));let g=[];this.worker=new Ee,this.worker.addEventListener("message",P=>{P.data.event==="tru-seo-analysis-complete"&&(g=P.data.analysis,this.dispatchActions(g,h),this.worker.terminate())}),this.worker.postMessage({event:"tru-seo-analysis",analysisData:h})}setSidebarButtonScore(e){const s=document.getElementById("aioseo-post-settings-sidebar-button"),a=document.getElementById("aioseo-post-score");!s||!a||(s.className=80<e?"score-green":50<e?"score-orange":"score-red",w()||(s.classList.add("aioseo-score-button","classic-editor"),e=`${e}/100`),a.textContent=e)}dispatchActions(e,s){const a=m();e.forEach(r=>{r.action==="updateState"&&s.postEditedTitle&&_t()&&this.setSidebarButtonScore(r.data.seo_score),a[r.action](r.data)})}}const Nt=()=>{let t="";switch(!0){case J():t=K().title;break;case U():t=j().title;break;case D():t=W().title;break;case B():t=H().title;break;case R():t=V().title;break;case L():t=z().title;break;case q():t=Z().title;break}return t},Pe=()=>{const t=y();if(t.liveTags.post_title)return t.liveTags.post_title;let e;if(v()||k()){const s=document.querySelector("#post input#title");e=s?s.value:""}return w()&&(e=window.wp.data.select("core/editor").getCurrentPost().title),e||(e=Nt()),e&&t.updatePostTitle(e),e},Ct=()=>{let t;if(v()||k()){const e=document.querySelector("#post input#title");t=e?e.value:""}return w()&&(t=window.wp.data.select("core/editor").getEditedPostAttribute("title")),t||(t=Nt()),t},Te=async(t=!0)=>{let e=Pe();const s=Ct();if(e!==s){e=s;const a=m();if(y().updatePostTitle(e),!t)return;new x().runAnalysis({postId:a.currentPost.id,postData:{...a.currentPost},content:_(),slug:O()})}},kt=t=>t?(t=t.replaceAll(/\n\n/g," "),t=et(t,!1,"innerText"),t=t.replace(/\[.*?]/g,""),t.trim()):"",xt=()=>{let t="";switch(!0){case J():t=K().excerpt;break;case U():t=j().excerpt;break;case D():t=W().excerpt;break;case B():t=H().excerpt;break;case R():t=V().excerpt;break;case L():t=z().excerpt;break;case q():t=Z().excerpt;break}return t},ve=()=>{const t=y();if(t.liveTags.post_excerpt)return t.liveTags.post_excerpt;let e;return(v()||k())&&(e=At()),w()&&(e=window.wp.data.select("core/editor").getCurrentPost().excerpt),e||(e=xt()),e||(e=kt(vt())),e&&t.updatePostExcerpt(e),e},Ne=()=>{let t;return(v()||k())&&(t=At()),w()&&(t=window.wp.data.select("core/editor").getEditedPostAttribute("excerpt")),t||(t=xt()),t||(t=kt(_())),t},Ce=async(t=!0)=>{let e=ve();const s=Ne();if(e!==s){e=s;const a=m();if(y().updatePostExcerpt(e),!t)return;new x().runAnalysis({postId:a.currentPost.id,postData:{...a.currentPost},content:_(),slug:O()})}},At=()=>{let t="";const e=document.querySelector("#postexcerpt textarea#excerpt");if(t=e?e.value:"",document.querySelector("#wp-excerpt-wrap.tmce-active")){const s=window.tinyMCE?window.tinyMCE.get("excerpt"):"";s&&(t=s.getContent({format:"raw"}))}return t};let b="",A="";const ke=(t=!0)=>{var a,r,o,n,c,i,u;const e=y(),s=m();if(v()||k()){const l=document.querySelectorAll('#post input[name="post_category[]"]:checked');if(l.length){if((r=(a=s==null?void 0:s.currentPost)==null?void 0:a.primary_term)!=null&&r.category){const f=document.querySelector(`#categorychecklist input[value="${s.currentPost.primary_term.category}"]`);(o=f==null?void 0:f.parentNode)!=null&&o.innerText&&(b=f.parentNode.innerText,e.updateTaxonomyTitle(b))}else b!==l[0].parentNode.innerText&&(b=l[0].parentNode.innerText,e.updateTaxonomyTitle(l[0].parentNode.innerText));A=Array.from(l).map(f=>f.parentNode.innerText).join(", "),e.updateCategories(A)}else b!==""&&(b=A="",e.updateTaxonomyTitle(b),e.updateCategories(A))}if(w()){let l=[],f=[];const C=tt();if(((n=C.aioseo.user.data.allcaps)!=null&&n.manageCategories||(c=C.aioseo.user.data.allcaps)!=null&&c.manage_categories)&&(l=window.wp.data.select("core").getEntityRecords("taxonomy","category"),f=window.wp.data.select("core/editor").getEditedPostAttribute("categories")),f&&f.length&&l){const h=((u=(i=s==null?void 0:s.currentPost)==null?void 0:i.primary_term)==null?void 0:u.category)||f[0],g=l.find(S=>S.id===h);g&&b!==g.name&&(b=g.name,e.updateTaxonomyTitle(b)),A=l.filter(S=>f.includes(S.id)).map(S=>S.name).join(", "),e.updateCategories(A)}else b!==""&&(b=A="",e.updateTaxonomyTitle(b),e.updateCategories(A))}t&&new x().runAnalysis({postId:s.currentPost.id})},xe=(t=!1)=>{const e=m();if(e.currentPost.context!=="term")return;const s=y(),a=document.querySelector("#edittag input#name");a&&(s.updateTaxonomyTitle(a.value),a.addEventListener("input",()=>{s.updateTaxonomyTitle(a.value)}));const r=document.querySelector("#edittag textarea#description");r&&(s.updateTaxonomyDescription(r.value),r.addEventListener("input",()=>{s.updateTaxonomyDescription(r.value)}));const o=document.querySelector("#edittag input#slug");if(o){const n=G(o.value);s.updatePermalinkSlug(n),s.updatePermalink(e.currentPost.permalink.replace(`/${s.permalinkSlug}`,`/${n.replace(/ /gi,"-").replace(/[^a-z0-9-]/gi,"").toLowerCase()}`)),o.addEventListener("input",()=>{s.updatePermalinkSlug(n),s.updatePermalink(e.currentPost.permalink.replace(`/${s.permalinkSlug}`,`/${n.replace(/ /gi,"-").replace(/[^a-z0-9-]/gi,"").toLowerCase()}`))})}e.savePostState(),t&&x.runAnalysis({postId:e.currentPost.id})},Ae=(t=!1)=>{const e=m();if(e.currentPost.postType!=="attachment")return;const s=y(),a=document.querySelector("textarea#attachment_caption");a&&(s.updateAttachmentCaption(a.value),a.addEventListener("input",i=>{s.updateAttachmentCaption(i.target.value)}));const r=document.querySelector("textarea#attachment-details-caption");r&&(s.updateAttachmentCaption(r.value),r.addEventListener("input",i=>{s.updateAttachmentCaption(i.target.value)}));const o=document.querySelector("textarea#attachment_content");o&&(s.updateAttachmentDescription(o.value),o.addEventListener("input",i=>{s.updateAttachmentDescription(i.target.value)}));const n=document.querySelector("input#attachment_alt");n&&(s.updateAltTag(n.value),n.addEventListener("input",i=>{s.updateAltTag(i.target.value)}));const c=document.querySelector("input#attachment-details-alt-text");c&&(s.updateAltTag(n.value),c.addEventListener("input",i=>{s.updateAltTag(i.target.value)})),t&&new x().runAnalysis({postId:e.currentPost.id})},_t=()=>{var e,s;const t=m();return(e=t==null?void 0:t.currentPost)!=null&&e.id&&!!((s=t.currentPost)!=null&&s.isTruSeoEligible)||!1},Ke=()=>{var a,r,o;const t=tt();if(!((a=t.aioseo.screen)!=null&&a.postType)||((r=t.aioseo.screen)==null?void 0:r.postType)==="web-story")return!1;const e=m();return!!((o=N().options.advanced)!=null&&o.truSeo&&Rt(t.aioseo.screen.postType)&&!e.currentPost.isStaticPostsPage)},M=async(t=900,e=!0)=>{rt(async()=>{const s=gt(),a=m();await Te(!1),await we(!1),await Ce(!1),await fe(!1),await ye(!1),ke(!1),xe(!1),Ae(!1),rt(s.updateSchemaOutput,Math.max(t*2,1800)),e&&new x().runAnalysis({postId:a.currentPost.id})},t)},je=t=>{const e=t.getRangeAt(0),s=e.cloneRange();return s.collapse(!1),t.removeAllRanges(),t.addRange(s),t.extend(e.startContainer,e.startOffset),t},We=t=>{const e=new RegExp(" ","g");return t.replace(/&nbsp;/g," ").replace(e," ")},He=({element:t,property:e,value:s})=>{if(!t)return document.documentElement;let a=t.parentElement;for(;a;){if(a.isEqualNode(document.documentElement)||s===document.defaultView.getComputedStyle(a).getPropertyValue(e))return a;a=a.parentElement}},Ve=()=>{const t=document.createElement("div");return t.classList.add("aioseo-app"),t.style.position="absolute",t.style.zIndex="999",t.style.display="flex",t.setAttribute("tabindex",-1),t};export{x as T,Vt as a,j as b,V as c,Z as d,Ht as e,_ as f,K as g,ke as h,xe as i,Ae as j,Ct as k,ve as l,M as m,H as n,z as o,Ke as p,ot as q,We as r,Kt as s,_t as t,gt as u,He as v,je as w,Ve as x,Ne as y,jt as z};
